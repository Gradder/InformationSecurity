<html>
	<head>
		<title>Security is an important thing</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="icon" href="images/laws/shield.png">
		<link rel="stylesheet" href="assets/css/main.css" />
		<script src="assets/js/jquery-3.3.1.js"></script>
		<script>
		$(function(){
		$("#header").load("header.html");
		$("#here_footer").load("footer.html");
		});
		</script>
		<style type="text/css">
			.InnerUl{
				list-style-type: circle !important;
			}
		</style>
	</head>
	<body>

		<div id="header"></div>

		<!-- Banner -->
			<section id="banner">
				<div class="inner">
					<header>
						<h1>Потоковые шифры</h1>
					</header>
				</div>
			</section>

<br/><br/><br/>
		<!-- Three -->

		<a name="doktrina"></a>


		<div class="row move_left">
			<section class="12u 12u$(large)">
				<h3>Введение</h3>
				<p>     Поточный шифр (stream cipher) выполняет преобразование входного сообщения по одному биту (или байту) за операцию. Поточный алгоритм шифрования устраняет необходимость разбивать сообщение на целое число блоков достаточно большой длины, следовательно, он может работать в реальном времени. Таким образом, если передается поток символов, каждый символ может шифроваться и передаваться сразу.

    
			</section>


	<section class="6u 12u$(medium)">
		<h3>Общая информация</h3>
<p>     Работа типичного поточного шифра показана на картинке справа.</p>
	</section>

			<section class="6u 12u$(medium)">

					<img src="images/lectures/Stream_Encryption/Stream_encryption.jpg" alt="" class="image_lectures and_right">

			</section>

			<section class="12u 12u$(large)">
				<p>    Как правило в качестве генераторов ключей в поточных шифрах используются <b>генераторы псевдослучайных чисел</b>(ГПСЧ). Целью использования таких генераторов  является получение "бесконечного" ключевого слова, располагая относительно малой длиной самого ключа. ГПСЧ создает последовательность битов, похожую на случайную. На самом деле, конечно же, такие последовательности вычисляются по определенным правилам и не являются случайными, поэтому они могут быть абсолютно точно воспроизведены как на передающей, так и на принимающей стороне. Но для использвания генератора псевдослучайных чисел в поточных шфирах, генератор должен иметь определенные свойства.
			<br>		
		 </br><b>Необходмые свойства ГПСЧ для использование его в криптографии:</b>
		 <ul>
		 	<li>период последовательности должен быть очень большой;</li>
		 	<li>порождаемая последовательность должна быть "почти" неотличима от действительно случайной;</li>
		 	<li>вероятности порождения различных значений должны быть в точности равны;</li>
		 	<li>для того, чтобы только законный получатель мог расшифровать сообщение, следует при получении потока ключевых битов k<sub>i</sub> использовать и учитывать некоторый секретный ключ, причем вычисление числа k<sub>i+1</sub> по известным предыдущим элементам последовательности k<sub>i</sub> без знания ключа должно быть трудной задачей.</li>
		 </ul></p>

		<h3>Генераторы псевдослучайных чисел на основе сдвиговых регистров с обратной связью</h3>
		<p>
			<a name="Generator"></a>
			В теории кодирования и криптографии широко применяются так называемые сдвиговые регистры с обратной связью. Они использовались в аппаратуре шифрования еще до начала массового использования ЭВМ и современных высокоскоростных программных шифраторов.
			Сдвиговые регистры с обратной связью могут применяться для получения потока псевдослучайных бит. Сдвиговый регистр с обратной связью состоит из двух частей: собственно n-битного сдвигового регистра и устройства обратной связи.
			<center><br>Сдвиговый регистр с обратой связью.</center>
			<img src="images/lectures/Stream_Encryption/Registr_shift.jpg" alt="" class="image_lectures and_center">
 			Извлекать биты из сдвигового регистра можно только по одному. Если необходимо извлечь следующий бит, все биты регистра сдвигаются вправо на 1 разряд. При этом на вход регистра слева поступает новый бит, который формируется устройством обратной связи и зависит от всех остальных битов сдвигового регистра. За счет этого биты регистра изменяются по определенному закону, который и определяет схему получения ПСЧ. Понятно, что через некоторое количество тактов работы регистра последовательность битов начнет повторяться. Длина получаемой последовательности до начала ее повторения называется периодом сдвигового регистра.
 			<br><br>
 			<a name="Line"></a>
 			Простейшим видом сдвигового регистра с обратной связью является <b>линейный сдвиговый регистр с обратной связью</b> (linear feedbackshift register – LFSR). Обратная связь в этом устройстве реализуется просто как сумма по модулю 2 всех (или некоторых) битов регистра. Биты, которые участвуют в обратной связи, образуют отводную последовательность. Линейные сдвиговые регистры с обратной связью или их модификации часто применяется в криптографии.
			Для того, чтобы стало понятнее, как работает сдвиговый регистр с обратной связью, <b>рассмотрим 4-битовый LFSR</b> с отводом от первого и четвертого разрядов, представленный на рисунке ниже.
			<img src="images/lectures/Stream_Encryption/fourRegistr.jpg" alt="" class="image_lectures and_center">

			На каждом шаге все содержимое регистра сдвигается вправо на один разряд. При этом можно получить в качестве результата один бит. На освободившееся слева место поступает бит, равный результату вычисления функции обратной связи f=b1⊕b4. Выходную последовательность генератора псевдослучайных бит образует последний столбец таблицы (извлекаемый бит).
			<center>Последовательность работы линейного сдвигового регистра.</center>
			<img src="images/lectures/Stream_Encryption/Table.png" alt="" class="image_lectures and_center">

			Линейный сдвиговый регистр размером n бит может находиться в одном из 2<sup>n</sup>-1 состояний (исключается состояние регистра из одних нулей - при появлении такого состояния далее будут порождаться лишь нули, и о псевдослучаности порождаемой последовательности говорить не приходится). Поэтому теоретически такой регистр может генерировать псевдослучайную последовательность с максимальным периодом 2<sup>n</sup>-1. Линейный сдвиговый регистр с обратной связью будет генерировать циклическую последовательность битов с максимальным периодом только при выборе в качестве отводной последовательности определенных бит. Разработана математическая теория, позволяющая выбрать подходящие номера разрядов для бит отводной последовательности.
			
			<br><br>Линейные сдвиговые регистры с обратной связью часто использовались и используются до сих пор при шифровании потоков данных. Для повышения криптостойкости в таких устройствах шифрования применяются комбинации нескольких сдвиговых регистров с обратной связью, а также вводятся дополнительные перемешивающие операции. Такие электронные схемы предлагались и выпускались еще до второй мировой войны. Аналогичные принципы заложены и в некоторые поточные шифры, созданные в конце XX века, например, в алгоритм А5, использовавшийся в Европе для шифрования сотовых цифровых каналов связи стандарта GSM. Несмотря на то, что некоторые криптоаналитики высказывают сомнения в надежности алгоритмов поточного шифрования с использованием линейных сдвиговых регистров с обратной связью, они положены в основу функционирования различных военных и гражданских устройств связи, используемых до настоящего времени.
			
			<br><br>Основным недостатком генераторов псевдослучайных чисел на базе линейных сдвиговых регистров является сложность программной реализации. Сдвиги и битовые операции легко и быстро выполняются в электронной аппаратуре, поэтому в разных странах выпускаются микросхемы и устройства для поточного шифрования на базе алгоритмов с использованием сдвиговых регистров с обратной связью.
			<br><br>
			<b>Есть несколько причин использования линейных регистров сдвига в криптографии:</b>
			<ui>
				<li>высокое быстродействие криптографических алгоритмов;</li>
				<li>применение только простейших операций сложения и умножения, аппаратно реализованных практически во всех вычислительных устройствах;</li>
				<li>хорошие криптографические свойства (генерируемые последовательности имеют большой период и хорошие статистические свойства);</li>
				<li>легкость анализа с использованием алгебраических методов за счет линейной структуры;</li>
			</ui>

			<img src="images/lectures/Stream_Encryption/line_registr.png" alt="" class="image_lectures and_center">
			</p>
			<p><b>Нелинейная комбинация генераторов</b> 
			</p>
		<center>Нелинейная комбинация генераторов</center>
		<img src="images/lectures/Stream_Encryption/Registr3.png" alt="" class="image_lectures and_center">
		<br>
		<p><b>Генератор Геффа.</b> В этом генераторе потока ключей используются три LFSR, объединенные нелинейным образом. Два LFSR являются входами мультиплексора, а третий LFSR управляет выходом мультиплексора. Если а1, а2 и а3 - выходы трех LFSR, выход генератора Геффа (Geffe) можно описать как:
		<br><b>b= a1<sup>a2</sup> — a1<sup>a3</sup>.</b><br>
		Если длины LFSR равны n1 n2 и n3, соответственно, то линейная сложность генератора равна:
		<br><b>(n1+1)*n2+n1*n3.</b><br>

Период генератора равен наименьшему общему делителю периодов трех генераторов. При условии, что степени трех примитивных многочленов обратной связи взаимно просты, период этого генератора будет равен произведению периодов трех LFSR.
		</p>
		<center>Генератор Геффа</center>
		<img src="images/lectures/Stream_Encryption/Registr4.png" alt="" class="image_lectures and_center">
		<br>


		<h3>Генераторы на нелинейных фильтрах</h3>
		<center>Генератор на нелинейном фильтре</center>
		<img src="images/lectures/Stream_Encryption/Registr5.png" alt="" class="image_lectures and_center">
		<p>
			В нелинейных комбинациях генераторов и генераторах на нелинейных фильтрах перемещение данных во всех РСЛОС контролируется одним синхросигналом.
			Основная идея функционирования рассматриваемого типа генераторов — внести нелинейность в работу генераторов потока ключей, основанных на РСЛОС, путём управления синхросигналом одного регистра выходной последовательностью другого.
			Есть 2 типа генераторов, основанных на управлении синхросигналом:
			<ui>
				<li>генератор переменного шага;</li>
				<li>сжимающий генератор.</li>
			</ui>

		<p><b>Основная идея:</b> РСЛОС 1 используется для управления передвижением битов двух других РСЛОС 2 и 3.</p>
		<center>Генератор переменного шага.</center>
		<img src="images/lectures/Stream_Encryption/Registr1.png" alt="" class="image_lectures and_center">
		
		<center>Сжимающий генератор.</center>
		<img src="images/lectures/Stream_Encryption/Registr2.png" alt="" class="image_lectures and_center">
		Контролирующий регистр РСЛОС 1 используется для управления выходом РСЛОС 2. 
		</p>

		<h3>Криптоанализ. Атаки на поточные шифры</h3>
		<p>
			<b>Силовые атаки</b>
			<br><br><a name ="Attack"></a>
			К этому классу относятся атаки, осуществляющие полный перебор всех возможных вариантов. Сложность полного перебора зависит от количества всех возможных решений задачи (в частности, размера пространства ключей или пространства открытых текстов). Этот класс атак применим ко всем видам систем поточного шифрования. При разработке систем шифрования разработчики стремятся сделать так, чтобы этот вид атак был наиболее эффективным по сравнению с другими существующими методами взлома.
			<br><br>
			<b>Статистические атаки</b>
			<br><br>
			Статистические атаки делятся на два подкласса:
			<ul>
				<li>метод криптоанализа статистических свойств шифрующей гаммы: направлен на изучение выходной последовательности криптосистемы; криптоаналитик пытается установить значение следующего бита последовательности с вероятностью выше вероятности случайного выбора с помощью различных статистических тестов.</li>
				<li>метод криптоанализа сложности последовательности: криптоаналитик пытается найти способ генерировать последовательность, аналогичную гамме, но более просто реализуемым способом.
			</ul>
			Оба метода используют принцип линейной сложности.
			<br><br>
			<b>Аналитические атаки</b>
			<br><br>
			Этот вид атак рассматривается в предположении, что криптоаналитику известны описание генератора, открытый и соответствующий закрытый тексты. Задача криптоаналитика определить использованный ключ (начальное заполнение регистров). Виды аналитических атак, применяемые к синхронным поточным шифрам:
			<ul>
				<li>корреляционные</li>
				<li>компромисс “время-память”</li>
				<li>инверсионная</li>
				<li>“предполагай и определяй”</li>
				<li>на ключевую загрузку и реинициализацию</li>
				<li>XSL-атака</li>
			</ul>
			<i>Корреляционные атаки</i><br>
Являются наиболее распространёнными атаками для взлома поточных шифров.
Известно, что работа по вскрытию криптосистемы может быть значительно сокращена, если нелинейная функция пропускает на выход информацию о внутренних компонентах генератора. Поэтому для восстановления начального заполнения регистров корреляционные атаки исследуют корреляцию выходной последовательности шифросистемы с выходной последовательностью регистров.
<br><br><i>Компромисс «время-память»</i><br>
Цель данной атаки — восстановление исходного состояния регистра сдвига (нахождение ключа), используя известную схему устройства и фрагмент шифрующей последовательности. Сложность атаки зависит от размера шифра и длины перехваченной гаммы.
<br>Состоит из двух этапов:
<ui>
	<li>построение большого словаря, в котором записаны всевозможные пары «состояние-выход»;</li>
	<li>предположение о начальном заполнении регистра сдвига, генерация выхода, просмотр перехваченной выходной последовательности и поиск соответствия со сгенерированным выходом. Если произошло совпадение, то данное предположительное заполнение с большой вероятностью является начальным.</li>
</ui>
<br>
<i>«Предполагай и определяй»</i><br>
Атака основывается на предположении, что криптоаналитику известны гамма, полином обратной связи, количество сдвигов регистра между выходами схемы и фильтрующая функция. 
<br>Состоит из трёх этапов:
<ui>
	<li>предположение о заполнении некоторых ячеек регистра;</li>
	<li>определение полного заполнения регистра на основании предположения о знании криптоаналитика;</li>
	<li>генерация выходной последовательности; если она совпадает с гаммой, то предположение на первом этапе было верно; если не совпадает, то возвращаемся к этапу 1.</li>
Сложность алгоритма зависит от устройства генератора и от количества предположений.
</ui>
		</p> <a name="BerklempMessi"></a>
			<img src="images/lectures/Stream_Encryption/Teor1.png">
			<img src="images/lectures/Stream_Encryption/Teor2.png">
			<img src="images/lectures/Stream_Encryption/Teor3.png">
			<img src="images/lectures/Stream_Encryption/Teor4.png">
			<img src="images/lectures/Stream_Encryption/Teor5.png">
		<p>
			<h3>Алгоритм А5</h3>
			<a name="A5"></a>
			<b>А5</b> — это поточный алгоритм шифрования, используемый для обеспечения конфиденциальности передаваемых данных между телефоном и базовой станцией в европейской системе мобильной цифровой связи GSM (Groupe Spécial Mobile).
Шифр основан на побитовом сложении по модулю два (булева операция «исключающее или») генерируемой псевдослучайной последовательности и шифруемой информации. В A5 псевдослучайная последовательность реализуется на основе трёх линейных регистров сдвига с обратной связью. Регистры имеют длины 19, 22 и 23 бита соответственно. Сдвигами управляет специальная схема, организующая на каждом шаге смещение как минимум двух регистров, что приводит к их неравномерному движению. Последовательность формируется путём операции «исключающее или» над выходными битами регистров.
Изначально французскими военными специалистами-криптографами был разработан поточный шифр для использования исключительно в военных целях. В конце 80-х для стандарта GSM потребовалось создание новой, современной системы безопасности. В её основу легли три секретных алгоритма: аутентификации — A3, шифрования потока — A5, генерации сеансового ключа — А8. В качестве алгоритма A5 была использована французская разработка. Этот шифр обеспечивал достаточно хорошую защищённость потока и, следовательно, конфиденциальность разговора. Изначально экспорт стандарта из Европы не предполагался, но вскоре в этом появилась необходимость. Именно поэтому А5 переименовали в А5/1 и стали распространять как в Европе, так и в США. Для остальных стран (в том числе и России) алгоритм модифицировали, значительно понизив криптостойкость шифра. А5/2 был специально разработан как экспортный вариант для стран, не входивших в Евросоюз. Криптостойкость А5/2 была понижена добавлением ещё одного регистра (17 бит), управляющего сдвигами остальных. В А5/0 шифрование отсутствует совсем. В настоящее время разработан также алгоритм А5/3, основанный на алгоритме Касуми и утверждённый для использования в сетях 3G. Эти модификации обозначают как A5/x.
<br><br>

		Алгоритм A5 в настоящее время — это целое семейство шифров. Для описания возьмем А5/1, как родоначальника этого семейства. Изменения в производных алгоритмах опишем отдельно.
		<br><center>Схема поточного шифра: сложение открытого текста и последовательности бит даёт шифротекст</center>
		<img src="images/lectures/Stream_Encryption/ShemeOfRegistr.png" alt="" class="image_lectures and_center">
		<br>
		В этом алгоритме каждому символу открытого текста соответствует символ шифротекста. Текст не делится на блоки (как в блочном шифровании) и не изменяется в размере. Для упрощения аппаратной реализации и, следовательно, увеличения быстродействия используются только простейшие операции: сложение по модулю 2 (XOR) и сдвиг регистра.
Формирование выходной последовательности происходит путём сложения потока исходного текста с генерируемой последовательностью (гаммой). Особенность операции XOR заключается в том, что применённая чётное число раз, она приводит к начальному значению. Отсюда, декодирование сообщения происходит путём сложения шифротекста с известной последовательностью.
Таким образом, безопасность системы полностью зависит от свойств последовательности. В идеальном случае каждый бит гаммы — это независимая случайная величина, и сама последовательность является случайной. Такая схема была изобретена Вернамом в 1917 году и названа в его честь. Как доказал Клод Шеннон в 1949 году, это обеспечивает абсолютную криптостойкость. Но использование случайной последовательности означает передачу по защищённому каналу сообщения, равного по объёму открытому тексту, что значительно усложняет задачу и практически нигде не используется.
В реальных системах создаётся ключ заданного размера, который без труда передаётся по закрытому каналу. Последовательность генерируется на его основе и является псевдослучайной. Большой класс поточных шифров (в том числе A5) составляют шифры, генератор псевдослучайной последовательности которой основан на регистрах сдвига с линейной обратной связью.
		<br><center>Система РСЛОС в А5</center>
		<img src="images/lectures/Stream_Encryption/A5Registr.png" alt="" class="image_lectures and_center">
<br><br>
	Сам по себе РСЛОС легко поддаётся криптоанализу и не является достаточно надёжным для использования в шифровании. Практическое применение имеют системы регистров переменного тактирования с различными длинами и функциями обратной связи.
	<br><br>Структура алгоритма А5 выглядит следующим образом:
		<ul>
			<li>Три регистра(R1, R2, R3) имеют длины 19, 22 и 23 бита</li>
			<li>Многочлены обратных связей:
				<br><img src="images/lectures/Stream_Encryption/Formul_2.png">
			</li>
			<li>Управление тактированием осуществляется специальным механизмом:
			<ul class="InnerUl">
				<li>в каждом регистре есть биты синхронизации: 8 (R1), 10 (R2), 10 (R3);</li>
				<li>вычисляется функция F = x&y|x&z|y&z, где & — булево AND, | - булево OR, а x, y и z — биты синхронизации R1, R2 и R3 соответственно;</li>
				<li>сдвигаются только те регистры, у которых бит синхронизации равен F;</li>
				<li>фактически, сдвигаются регистры, синхробит которых принадлежит большинству;</li>
			</ul>
		</li>
			<li>Выходной бит системы — результат операции XOR над выходными битами регистров.</li>
		</ul>
		</p>

		<h3>Функционирование алгоритма А5</h3>
		<p>
			Рассмотрим особенности функционирования алгоритма на основе известной схемы. Передача данных осуществляется в структурированном виде — с разбивкой на кадры (114 бит). Перед инициализацией регистры обнуляются, на вход алгоритма поступают сеансовый ключ (K — 64 бита), сформированный А8, и номер кадра (Fn — 22 бита). Далее последовательно выполняются следующие действия:
			<ul>
				<li>Инициализация:
				<ul class="InnerUl">
					<li>64 такта, при которых очередной бит ключа XOR-ится с младшим битом каждого регистра, регистры при этом сдвигаются на каждом такте;</li>
					<li>аналогичные 22 такта, только операция XOR производится с номером кадра;</li>
					<li>100 тактов с управлением сдвигами регистров, но без генерации последовательности;</li>
				</ul></li>
				<li>228 (114 + 114) тактов рабочие, происходит шифрование передаваемого кадра (первые 114 бит) и дешифрование (последние 114 бит) принимаемого;</li>
				<li>далее инициализация производится заново, используется новый номер кадра.</li>
			</ul>
		</p>

		<h3>Криптостойкость</h3>
		<p>
			Разработка стандарта GSM подразумевала мощный аппарат шифрования, не поддающийся взлому (особенно в реальном времени). Используемые разработки при надлежащей реализации обеспечивали качественное шифрование передаваемых данных. Именно такую информацию можно получить от компаний, распространяющих этот стандарт. Но стоит отметить важный нюанс: прослушивание разговоров — неотъемлемый атрибут, используемый спецслужбами. Они были заинтересованы в возможности прослушивания телефонных разговоров для своих целей. Таким образом, в алгоритм были внесены изменения, дающие возможность взлома за приемлемое время. Помимо этого, для экспорта A5 модифицировали в A5/2. В MoU (Memorandum of Understand Group Special Mobile standard) признают, что целью разработки A5/2 было понижение криптостойкости шифрования, однако в официальных результатах тестирования говорится, что неизвестно о каких-либо недостатках алгоритма.
			<br><br>
			<br><b>Известные уязвимости</b><br>
			С появлением данных о стандарте A5 начались попытки взлома алгоритма, а также поиска уязвимостей. Огромную роль оказали особенности стандарта, резко ослабляющие защиту, а именно:
			<ul>
				<li>10 бит ключа принудительно занулены;</li>
				<li>отсутствие перекрестных связей между регистрами (кроме управления сдвигами);</li>
				<li>шифрование служебной информации, известной криптоаналитику;</li>
				<li>свыше 40 % ключей приводит к минимальной длине периода генерируемой последовательности, а именно <b>(4/3)*(2<sup>23</sup>-1)</b></li>
				<li>в начале сеанса осуществляется обмен нулевыми сообщениями (по одному кадру);</li>
				<li>одинаковое дополнение (padding) для всех пакетов;</li>
				<li>в A5/2 движение осуществляется отдельным регистром длиной 17 бит.</li>
			</ul>
			На основе этих «дыр» в алгоритме построены схемы взлома.
			<br><br>
			<br><b>Известные атаки</b><br>
			Ключом является сеансовый ключ длиной 64 бита, номер кадра считается известным. Таким образом, сложность атаки, основанной на прямом переборе, равна 2<sup>64</sup>.
Первые обзоры шифра (работа Росса Андерсона) сразу выявили уязвимость алгоритма — из-за уменьшения эффективной длины ключа (зануление 10 бит) сложность упала до 2<sup>45</sup> (сразу на 6 порядков). Атака Андерсона основана на предположении о начальном заполнении коротких регистров и по выходным данным получения заполнения третьего.
В 1997 году Йован Голич опубликовал результаты анализа А5. Он предложил способ определения первоначального заполнения регистров по известному отрезку гаммы длиной всего 64 бита. Этот отрезок получают из нулевых сообщений. Атака имеет среднюю сложность 2<sup>40</sup>.
В 1999 году Вагнеру и Голдбергу без труда удалось продемонстрировать, что для вскрытия системы достаточно перебором определить начальное заполнение R4. Проверка осуществляется за счёт нулевых кадров. Сложность этой атаки равна 2<sup>17</sup>, таким образом, на современном компьютере вскрытие шифра занимает несколько секунд.
В декабре 1999 года группа израильских учёных (Ади Шамир, Алекс Бирюков, а позже и американец Дэвид Вагнер (англ.)) опубликовали весьма нетривиальный, но теоретически очень эффективный метод вскрытия A5/1:

<blockquote> Это весьма сложная идея, реализуя которую мы наступаем на многих фронтах, чтобы накопить несколько небольших преимуществ, но сложенные все вместе, они дают большой выигрыш.</blockquote>

		</p>

			</section>
		</div>



<div id="here_footer"></div>


		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
	</body>
</html>
